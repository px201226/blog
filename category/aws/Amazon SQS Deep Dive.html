<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Amazon SQS 딥다이브 | 끄적끄적 개발일지</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script src="https://www.googletagmanager.com/gtag/js?id=G-SE0BLFFFMG"></script>
    <meta name="description" content="Awesome description">
    
    <link rel="preload" href="/assets/css/0.styles.4bffb705.css" as="style"><link rel="preload" href="/assets/js/app.70752fd1.js" as="script"><link rel="preload" href="/assets/js/17.4dcf5890.js" as="script"><link rel="preload" href="/assets/js/3.6ee8ed88.js" as="script"><link rel="prefetch" href="/assets/js/10.1fe66b22.js"><link rel="prefetch" href="/assets/js/11.3e8e6dd5.js"><link rel="prefetch" href="/assets/js/12.96743d99.js"><link rel="prefetch" href="/assets/js/13.5cab9bdd.js"><link rel="prefetch" href="/assets/js/14.e412fb10.js"><link rel="prefetch" href="/assets/js/15.1da5e3dc.js"><link rel="prefetch" href="/assets/js/16.8ebbd2f8.js"><link rel="prefetch" href="/assets/js/18.5bfa6a85.js"><link rel="prefetch" href="/assets/js/19.12bd999a.js"><link rel="prefetch" href="/assets/js/2.0c177ed1.js"><link rel="prefetch" href="/assets/js/20.87648ee0.js"><link rel="prefetch" href="/assets/js/21.7fbb071c.js"><link rel="prefetch" href="/assets/js/22.3f3676f6.js"><link rel="prefetch" href="/assets/js/23.114b4211.js"><link rel="prefetch" href="/assets/js/24.7077956a.js"><link rel="prefetch" href="/assets/js/25.42ad01f0.js"><link rel="prefetch" href="/assets/js/26.c356a4d4.js"><link rel="prefetch" href="/assets/js/27.52a125bd.js"><link rel="prefetch" href="/assets/js/28.692ecc68.js"><link rel="prefetch" href="/assets/js/29.d205c4cb.js"><link rel="prefetch" href="/assets/js/30.c221f26d.js"><link rel="prefetch" href="/assets/js/31.65e9c8ce.js"><link rel="prefetch" href="/assets/js/32.7ddfb0f5.js"><link rel="prefetch" href="/assets/js/33.7f74862d.js"><link rel="prefetch" href="/assets/js/34.21b19958.js"><link rel="prefetch" href="/assets/js/35.428cdea5.js"><link rel="prefetch" href="/assets/js/36.ef46a37e.js"><link rel="prefetch" href="/assets/js/37.290a8b87.js"><link rel="prefetch" href="/assets/js/38.61002123.js"><link rel="prefetch" href="/assets/js/39.fbbd1cce.js"><link rel="prefetch" href="/assets/js/4.39bb3471.js"><link rel="prefetch" href="/assets/js/40.ee500a11.js"><link rel="prefetch" href="/assets/js/41.ce50acc7.js"><link rel="prefetch" href="/assets/js/42.b0e56f29.js"><link rel="prefetch" href="/assets/js/43.c4683cd4.js"><link rel="prefetch" href="/assets/js/44.4fd9959c.js"><link rel="prefetch" href="/assets/js/45.10201422.js"><link rel="prefetch" href="/assets/js/5.6b61195e.js"><link rel="prefetch" href="/assets/js/6.d4a6ae6d.js"><link rel="prefetch" href="/assets/js/7.8da69c67.js"><link rel="prefetch" href="/assets/js/8.8044f9c2.js"><link rel="prefetch" href="/assets/js/9.8e23472b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4bffb705.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div data-app="true" id="app" class="v-application v-application--is-ltr theme--light" style="background:#F3F5F7;"><div class="v-application--wrap"><div class="container pa-0" style="max-width:900px;"><link href="https://fonts.googleapis.com/css?family=Jura" rel="stylesheet"> <div class="text-center py-8 v-toolbar__title v-app-bar-title" style="font-family:'Jura';"><div class="v-app-bar-title__content"><h1 class="primary--text">끄적끄적 개발일지</h1></div><div class="v-app-bar-title__placeholder" style="visibility:visible;"><h1 class="primary--text">끄적끄적 개발일지</h1></div></div> <div role="list" class="v-list pa-0 v-sheet theme--light v-list--flat transparent"><div role="listbox" class="v-item-group theme--light v-list-item-group indigo--text"><div class="row mb-0 text-center no-gutters justify-center"><div class="col-lg-2 col"><a href="/" tabindex="0" block="" text="" role="option" aria-selected="false" class="py-2  v-list-item v-list-item--link theme--light primary--text"><div class="v-list-item__title">Home</div></a></div> <div class="col-lg-2 col"><a href="/category" aria-current="page" tabindex="0" block="" text="" role="option" aria-selected="false" class="py-2 v-item--active v-list-item--active v-list-item v-list-item--link theme--light primary--text"><div class="v-list-item__title">Category</div></a></div> <div class="col-lg-2 col"><a href="/profiles" tabindex="0" block="" text="" role="option" aria-selected="false" class="py-2 v-list-item v-list-item--link theme--light primary--text"><div class="v-list-item__title">Profiles</div></a></div></div></div></div> <hr role="separator" aria-orientation="horizontal" class="mb-3 v-divider theme--light"> <div><div data-v-52bca676><div class="px-0 col col-12" data-v-52bca676 data-v-52bca676><div class="pa-5 px-md-7 v-card v-sheet theme--light elevation-1" data-v-52bca676><div data-v-52bca676><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html" aria-current="page" class="text-h4 font-weight-bold router-link-exact-active router-link-active" data-v-52bca676><div data-v-52bca676><!----></div>
          Amazon SQS 딥다이브
        </a> <br data-v-52bca676> <span class="text-caption grey--text text--darken-1 " data-v-52bca676>2023-06-19 &gt; AWS
        </span></div> <hr role="separator" aria-orientation="horizontal" class="mt-4 mb-4 v-divider theme--light" data-v-52bca676> <div class="theme-container" data-v-52bca676><div class="toc" data-v-52bca676><ul><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#대기열-유형">대기열 유형</a><ul><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#표준-대기열-standard">표준 대기열(Standard)</a></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#fifo-대기열">FIFO 대기열</a></li></ul></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#fifo-큐란-무엇인가">FIFO 큐란 무엇인가?</a><ul><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#일반적인-queue">일반적인 Queue</a></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#멀티-스레드-환경에서의-문제점">멀티 스레드 환경에서의 문제점</a></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#producer-→-queue-로의-순서보장">Producer → Queue 로의 순서보장</a></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#queue-→-consumer-로의-순서보장">Queue → Consumer 로의 순서보장</a></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#sqs-fifo-큐에서-해결한-방식">SQS FIFO 큐에서 해결한 방식</a></li></ul></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#분산-시스템에서-메시지-동기화-문제">분산 시스템에서 메시지 동기화 문제</a></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#sqs가-메시지-처리를-하는-방법">SQS가 메시지 처리를 하는 방법</a></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#at-least-once-delivery">At-least-once delivery</a></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#exactly-one-processing">Exactly One Processing</a><ul><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#producer-가-queue로-메시지를-전송했지만-producer가-ack-응답을-받지-못하여-메시지-전송실패로-알고-재전송-하는-경우">Producer 가 Queue로 메시지를 전송했지만, Producer가 Ack 응답을 받지 못하여 메시지 전송실패로 알고 재전송 하는 경우</a></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#consumer-가-메시지를-처리하고-deletemessage-를-호출하였지만-sqs-내부의-분산된-저장구조-특성-탓에-몇몇-메시지-복사본이-삭제되지-않고-consumer에게-재전송되는-경우">Consumer 가 메시지를 처리하고 DeleteMessage 를 호출하였지만, SQS 내부의 분산된 저장구조 특성 탓에 몇몇 메시지 복사본이 삭제되지 않고 Consumer에게 재전송되는 경우</a></li></ul></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#polling">Polling</a><ul><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#short-polling-짧은-폴링">Short Polling (짧은 폴링)</a></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#long-poliing-긴-폴링">Long Poliing (긴 폴링)</a></li></ul></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#fifo-큐의-한계">FIFO 큐의 한계</a></li><li><a href="/category/aws/Amazon%20SQS%20Deep%20Dive.html#참고자료">참고자료</a></li></ul></div> <div class="theme-default-content custom post markdown-body content__default" data-v-52bca676><h2 id="대기열-유형"><a href="#대기열-유형" class="header-anchor">#</a> 대기열 유형</h2> <h3 id="표준-대기열-standard"><a href="#표준-대기열-standard" class="header-anchor">#</a> 표준 대기열(Standard)</h3> <ul><li><strong>무제한 처리량</strong> : API 작업당 거의 무제한의 TPS를 지원</li> <li><strong>최소한 한 번 전달(At-least-once delivery)</strong> : 메시가 최소한 한 번 전달되고, 가끔 2개 이상의 메시지 복사본이 전달될 수 있다.</li> <li><strong>순서 보장을 위해 최선의 노력</strong> : 가끔 메시지가 전송된 순서와 다르게 전달될 수 있음.</li></ul> <p><img src="data:image/png;base64,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" alt="Untitled"></p> <h3 id="fifo-대기열"><a href="#fifo-대기열" class="header-anchor">#</a> FIFO 대기열</h3> <ul><li><strong>높은 처리량</strong>: 기본적으로 FIFO 대기열은 초당 최대 300개의 메시지(초당 300개의 전송, 수신 또는 삭제 작업)를 지원합니다. 작업당 최대 10개 메시지를 일괄 처리할 경우, FIFO 대기열은 초당 3000개의 메시지까지 지원할 수 있습니다.</li> <li><strong>정확히 한 번 처리(Exactly One Processing)</strong> : 메시지가 한 번 전달되고 소비자가 이를 처리 및 삭제할 때까지 유지됩니다. 중복 메시지는 대기열에 올라가지 않습니다.</li> <li><strong>선입선출 전달</strong>: 메시지가 전송되고 수신되는 순서가 엄격하게 지켜집니다.</li></ul> <p><img src="data:image/png;base64,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" alt="Untitled"></p> <hr> <h2 id="fifo-큐란-무엇인가"><a href="#fifo-큐란-무엇인가" class="header-anchor">#</a> FIFO 큐란 무엇인가?</h2> <h3 id="일반적인-queue"><a href="#일반적인-queue" class="header-anchor">#</a> 일반적인 Queue</h3> <p><img src="/assets/img/Untitled_2.a576a3c6.png" alt="Untitled"></p> <ul><li>Queue에서 선입선출 방식으로 enqueue, dequeue할 수 있다.</li></ul> <h3 id="멀티-스레드-환경에서의-문제점"><a href="#멀티-스레드-환경에서의-문제점" class="header-anchor">#</a> 멀티 스레드 환경에서의 문제점</h3> <p><img src="/assets/img/Untitled_3.b683c940.png" alt="Untitled"></p> <ul><li>Producer와 Consumer가 다수(멀티스레드)인 환경에서는 FIFO(First In First Out)동작의 큐는 아무런 의미가 없다.
<ul><li>Producer → Queue 에서의 네트워크 지연 시간</li> <li>Queue → Consumer 에서의 네트워크 지연 시간</li> <li>Consumer 에서 실제 메시지를 처리하는 시간</li></ul></li> <li>클라이언트가 원하는것은 메시지를 (1,2,3) 을 보내면 (1,2,3) 순서대로 처리하고 싶은 것</li></ul> <h3 id="producer-→-queue-로의-순서보장"><a href="#producer-→-queue-로의-순서보장" class="header-anchor">#</a> Producer → Queue 로의 순서보장</h3> <ul><li>Producer 에서 메시지를 전송할 때, Timestamp 를 찍어서 메시지를 전송한다.</li> <li>Queue 에서는 FIFO 큐가 아니라 Timestamp 기준의 우선순위 큐를 구성한다.</li></ul> <h3 id="queue-→-consumer-로의-순서보장"><a href="#queue-→-consumer-로의-순서보장" class="header-anchor">#</a> Queue → Consumer 로의 순서보장</h3> <ul><li>가장 단순한 방법은 큐에서 Serializable하게 동기식으로 컨슈머에게 메시지를 전달하고 처리한다.</li></ul> <p><img src="/assets/img/Untitled_4.30926a1a.png" alt="Untitled"></p> <ul><li>하지만, 이 방식의 문제점은 컨슈머가 다수더라도 단일 스레드 환경처럼 동작하여 처리량이 낮다.</li></ul> <h3 id="sqs-fifo-큐에서-해결한-방식"><a href="#sqs-fifo-큐에서-해결한-방식" class="header-anchor">#</a> SQS FIFO 큐에서 해결한 방식</h3> <ul><li>SQS에서는 MessageGroup 이라는 개념을 적용하여 메시지를 논리적으로 하나의 그룹으로 묶는다.</li> <li>같은 그룹에 속하는 메시지는 앞에 메시지가 처리될 때까지 뒤에 들어온 메시지가 Blocking 되어 메시지 처리의 정확한 순서를 보장한다.</li> <li>같은 그룹이 아닌 메시지는 Blocking 되지 않으며, Consumer에게 큐잉된다.</li> <li>순서가 상관 없는 메시지는 서로 다른 그룹으로(A,B)로 지정한다.</li> <li>순서가 상관있는 메시지들끼리는 같은 그룹으로 지정한다.</li></ul> <hr> <h2 id="분산-시스템에서-메시지-동기화-문제"><a href="#분산-시스템에서-메시지-동기화-문제" class="header-anchor">#</a> 분산 시스템에서 메시지 동기화 문제</h2> <p><img src="/assets/img/Untitled_5.d7e92a3a.png" alt="Untitled"></p> <ul><li>시나리오
<ul><li>Producer 가 Queue 메시지를 전송한다.</li> <li>큐는 수신된 메시지를 저장하고 확인응답(ack)를 Producer에게 응답한다.</li> <li>확인응답(ack)가 유실되어, Producer1는 메시지를 재전송한다.</li> <li>결과적으로 메시지 1이 중복되서 큐에 저장이 된다.</li></ul></li> <li>Producer 에게 Ack 응답을 받으면 Message Commit하면 되지 않을까?
<ul><li><ol><li>Producer → Queue 메시지 1 전달</li></ol></li> <li><ol start="2"><li>Queue → Producer Ack 응답</li></ol></li> <li><ol start="3"><li>Producer → Queue Ack 응답</li></ol></li> <li><ol start="4"><li>Queue Message Commit</li></ol> <ul><li>여기서 장애가 나면?
<ul><li>Producer는 큐가 메시지를 정상적으로 받은 것으로 알고 있지만, 실제 Queue 에는 메시지가 정상적으로 저장되지 않았다. 즉 불일치가 발생한다.</li> <li>정확한 동기화를 위해서 무한대의 ack 가 필요하다.</li></ul></li></ul></li></ul></li></ul> <hr> <h2 id="sqs가-메시지-처리를-하는-방법"><a href="#sqs가-메시지-처리를-하는-방법" class="header-anchor">#</a> SQS가 메시지 처리를 하는 방법</h2> <p><img src="/assets/img/Untitled_6.818a3bf0.png" alt="Untitled"></p> <ul><li>Consumer 가 메시지를 수신하고 처리완료 후 큐에게 DeleteMessage 호출해야만 큐에서 메시지를 완전히 제거한다.</li> <li>하지만, 큐에 입장에서 Consumer가 메시지를 수신하고 정상적으로 처리해서 DeleteMessage를 호출한다는 보장이 없기 때문에, SQS는 메시지에 처리 시간 제한을 두었다.</li> <li>이 시간 제한을 Visibility Timeout 이라고 하며, Consumer가 메시지를 수신 후 Visibility Timeout 시간 동안 Delete Message를 하지 않으면 자동으로 롤백된다.
<ul><li>Consumer 가 메시지를 정상적으로 수신하면, SQS는 메시지를 바로 삭제하는 것이 아니라, 또 다른 Consumer가 해당 메시지를 수신하지 못하도록 막는다.</li> <li>Consumer 가 메시지를 수신하여, DeleteMessage 까지 한다면 큐에서 완전히 삭제한다.</li> <li>Consumer 가 Visibility Timeout 동안 DeleteMessage 하지 못한다면 메시지를 다른 컨슈머가 수신받을 수 있도록 원복시킨다.</li></ul></li></ul> <p><img src="/assets/img/Untitled_7.cf706448.png" alt="Untitled"></p> <p><img src="https://docs.aws.amazon.com/images/AWSSimpleQueueService/latest/SQSDeveloperGuide/images/sqs-visibility-timeout-diagram.png" alt="https://docs.aws.amazon.com/images/AWSSimpleQueueService/latest/SQSDeveloperGuide/images/sqs-visibility-timeout-diagram.png"></p> <hr> <h2 id="at-least-once-delivery"><a href="#at-least-once-delivery" class="header-anchor">#</a> At-least-once delivery</h2> <ul><li>Standard 대기열의 경우 최소한 한 번 전달(At-least-once delivery)를 지원한다.</li> <li>분산 시스템에서 메시지 동기화 문제 에서도 보았듯이 네트워크 문제로 아래와 같은 경우에 메시지가 두 번 이상 중복 발행될 수 있다.
<ul><li>Producer 가 Queue로 메시지를 전송했지만, Producer가 Ack 응답을 받지 못하여 메시지 전송실패로 알고 재전송 하는 경우
<ul><li>→ 큐에 중복된 메시지가 저장되므로 같은 메시지가 두번 발행될 수 있다.</li></ul></li> <li>Consumer 가 메시지를 처리하고 DeleteMessage 를 호출하였지만, <strong>SQS 내부의 분산된 저장구조 특성 탓에 몇몇 메시지 복사본이 삭제되지 않고</strong> Consumer에게 재전송되는 경우</li></ul></li></ul> <h2 id="exactly-one-processing"><a href="#exactly-one-processing" class="header-anchor">#</a> Exactly One Processing</h2> <ul><li>FIFO 대기열의 경우 정확히 한 번 처리(Exactly One Procession)을 지원한다.</li> <li>FIFO 대기열은 At-least-once delivery 에 엣지 케이스를 어떻게 해결했나?</li></ul> <h3 id="producer-가-queue로-메시지를-전송했지만-producer가-ack-응답을-받지-못하여-메시지-전송실패로-알고-재전송-하는-경우"><a href="#producer-가-queue로-메시지를-전송했지만-producer가-ack-응답을-받지-못하여-메시지-전송실패로-알고-재전송-하는-경우" class="header-anchor">#</a> Producer 가 Queue로 메시지를 전송했지만, Producer가 Ack 응답을 받지 못하여 메시지 전송실패로 알고 재전송 하는 경우</h3> <ul><li>FIFO 대기열은 ContentBasedDeduplication 또는 MessageDeduplicationId 기반으로 메시지 중복 제거를 지원</li> <li>ContentBasedDeduplication 은 메시지 컨텐츠를 SHA-256 으로 해쉬</li> <li>MessageDeduplicationId 은 Producer 가 직접 지정하여 메시지를 전송한다.</li> <li>둘 중 하나의 방식으로 FIFO 대기열은 전송 중복 제거를 구현한다. 중복된 메시지의 경우 큐에 저장하지 않는다.</li> <li>중복값은 SQS에서 5분 동안 기억하고 있으며, 5분이 지나면 같은 메시지를 보낼 수 있다.</li></ul> <h3 id="consumer-가-메시지를-처리하고-deletemessage-를-호출하였지만-sqs-내부의-분산된-저장구조-특성-탓에-몇몇-메시지-복사본이-삭제되지-않고-consumer에게-재전송되는-경우"><a href="#consumer-가-메시지를-처리하고-deletemessage-를-호출하였지만-sqs-내부의-분산된-저장구조-특성-탓에-몇몇-메시지-복사본이-삭제되지-않고-consumer에게-재전송되는-경우" class="header-anchor">#</a> Consumer 가 메시지를 처리하고 DeleteMessage 를 호출하였지만, SQS 내부의 분산된 저장구조 특성 탓에 몇몇 메시지 복사본이 삭제되지 않고 Consumer에게 재전송되는 경우</h3> <ul><li>정확한 방법에 대한 이야기는 없지만 해당 케이스는 표준 대기열에서만 발생하는 케이스라고 <a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/standard-queues.html" target="_blank" rel="noopener noreferrer">공식 문서<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>는 말한다.</li></ul> <hr> <h2 id="polling"><a href="#polling" class="header-anchor">#</a> Polling</h2> <h3 id="short-polling-짧은-폴링"><a href="#short-polling-짧은-폴링" class="header-anchor">#</a> Short Polling (짧은 폴링)</h3> <p><img src="/assets/img/Untitled_8.72df0ca5.png" alt="Untitled"></p> <h3 id="long-poliing-긴-폴링"><a href="#long-poliing-긴-폴링" class="header-anchor">#</a> Long Poliing (긴 폴링)</h3> <p><img src="/assets/img/Untitled_9.1e518364.png" alt="Untitled"></p> <hr> <h2 id="fifo-큐의-한계"><a href="#fifo-큐의-한계" class="header-anchor">#</a> FIFO 큐의 한계</h2> <ul><li>Producer의 부정확한 시계문제</li> <li>메시지 중복 5분 시간 제한 문제</li> <li>Visibility Timeout 엣지 케이스</li></ul> <h2 id="참고자료"><a href="#참고자료" class="header-anchor">#</a> 참고자료</h2> <ul><li><a href="https://ably.com/blog/sqs-fifo-queues-message-ordering-and-exactly-once-processing-guaranteed" target="_blank" rel="noopener noreferrer">SQS FIFO Queues: Message Ordering and Exactly-Once Processing Guaranteed? | Ably Blog: Data in Motion<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://awstip.com/how-to-efficiently-scale-aws-sqs-to-process-millions-of-messages-concurrently-in-spring-cloud-aws-c2431ed9e828" target="_blank" rel="noopener noreferrer">https://awstip.com/how-to-efficiently-scale-aws-sqs-to-process-millions-of-messages-concurrently-in-spring-cloud-aws-c2431ed9e828<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://sookocheff.com/post/messaging/dissecting-sqs-fifo-queues/" target="_blank" rel="noopener noreferrer">Dissecting SQS FIFO Queues — Does Ordered and Exactly Once Messaging Really Exist?<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://tomgregory.com/3-surprising-facts-about-aws-sqs-fifo-queues/" target="_blank" rel="noopener noreferrer">3 surprising facts about AWS SQS FIFO queues<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://aws.amazon.com/ko/blogs/developer/how-the-amazon-sqs-fifo-api-works/" target="_blank" rel="noopener noreferrer">https://aws.amazon.com/ko/blogs/developer/how-the-amazon-sqs-fifo-api-works/<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/welcome.html" target="_blank" rel="noopener noreferrer">What is Amazon Simple Queue Service? - Amazon Simple Queue Service<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div></div></div></div> <div data-v-52bca676></div></div></div></div> <footer prime="" class="v-footer mt-2 v-sheet theme--light v-footer--padless" style="background:#F3F5F7;"><div class="col col-12"><div class="text-center v-card v-card--flat v-sheet theme--light rounded-0" style="background:#F3F5F7;"><div class="v-card__text"><p>Copyright © 2021 All Right <em>끄적끄적 개발일지</em></p> <p>
          px201226@gmail.com .
          <a href="https://github.com/px201226" target="_blank">GitHub</a>
          .
          <a href="http://px201226.github.io/blog" target="_blank">Blog</a>
          .
        </p></div></div></div></footer></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.70752fd1.js" defer></script><script src="/assets/js/17.4dcf5890.js" defer></script><script src="/assets/js/3.6ee8ed88.js" defer></script>
  </body>
</html>
