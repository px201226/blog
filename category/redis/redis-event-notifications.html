<!DOCTYPE html>
<html lang="ko-KR">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis Keyspace Notifications에 대해 알아보자 | 끄적끄적 개발일지</title>
    <meta name="generator" content="VuePress 1.8.2">
    <script src="https://www.googletagmanager.com/gtag/js?id=G-SE0BLFFFMG"></script>
    <meta name="description" content="Awesome description">
    
    <link rel="preload" href="/assets/css/0.styles.4bffb705.css" as="style"><link rel="preload" href="/assets/js/app.70752fd1.js" as="script"><link rel="preload" href="/assets/js/17.4dcf5890.js" as="script"><link rel="preload" href="/assets/js/44.4fd9959c.js" as="script"><link rel="prefetch" href="/assets/js/10.1fe66b22.js"><link rel="prefetch" href="/assets/js/11.3e8e6dd5.js"><link rel="prefetch" href="/assets/js/12.96743d99.js"><link rel="prefetch" href="/assets/js/13.5cab9bdd.js"><link rel="prefetch" href="/assets/js/14.e412fb10.js"><link rel="prefetch" href="/assets/js/15.1da5e3dc.js"><link rel="prefetch" href="/assets/js/16.8ebbd2f8.js"><link rel="prefetch" href="/assets/js/18.5bfa6a85.js"><link rel="prefetch" href="/assets/js/19.12bd999a.js"><link rel="prefetch" href="/assets/js/2.0c177ed1.js"><link rel="prefetch" href="/assets/js/20.87648ee0.js"><link rel="prefetch" href="/assets/js/21.7fbb071c.js"><link rel="prefetch" href="/assets/js/22.3f3676f6.js"><link rel="prefetch" href="/assets/js/23.114b4211.js"><link rel="prefetch" href="/assets/js/24.7077956a.js"><link rel="prefetch" href="/assets/js/25.42ad01f0.js"><link rel="prefetch" href="/assets/js/26.c356a4d4.js"><link rel="prefetch" href="/assets/js/27.52a125bd.js"><link rel="prefetch" href="/assets/js/28.692ecc68.js"><link rel="prefetch" href="/assets/js/29.d205c4cb.js"><link rel="prefetch" href="/assets/js/3.6ee8ed88.js"><link rel="prefetch" href="/assets/js/30.c221f26d.js"><link rel="prefetch" href="/assets/js/31.65e9c8ce.js"><link rel="prefetch" href="/assets/js/32.7ddfb0f5.js"><link rel="prefetch" href="/assets/js/33.7f74862d.js"><link rel="prefetch" href="/assets/js/34.21b19958.js"><link rel="prefetch" href="/assets/js/35.428cdea5.js"><link rel="prefetch" href="/assets/js/36.ef46a37e.js"><link rel="prefetch" href="/assets/js/37.290a8b87.js"><link rel="prefetch" href="/assets/js/38.61002123.js"><link rel="prefetch" href="/assets/js/39.fbbd1cce.js"><link rel="prefetch" href="/assets/js/4.39bb3471.js"><link rel="prefetch" href="/assets/js/40.ee500a11.js"><link rel="prefetch" href="/assets/js/41.ce50acc7.js"><link rel="prefetch" href="/assets/js/42.b0e56f29.js"><link rel="prefetch" href="/assets/js/43.c4683cd4.js"><link rel="prefetch" href="/assets/js/45.10201422.js"><link rel="prefetch" href="/assets/js/5.6b61195e.js"><link rel="prefetch" href="/assets/js/6.d4a6ae6d.js"><link rel="prefetch" href="/assets/js/7.8da69c67.js"><link rel="prefetch" href="/assets/js/8.8044f9c2.js"><link rel="prefetch" href="/assets/js/9.8e23472b.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4bffb705.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div data-app="true" id="app" class="v-application v-application--is-ltr theme--light" style="background:#F3F5F7;"><div class="v-application--wrap"><div class="container pa-0" style="max-width:900px;"><link href="https://fonts.googleapis.com/css?family=Jura" rel="stylesheet"> <div class="text-center py-8 v-toolbar__title v-app-bar-title" style="font-family:'Jura';"><div class="v-app-bar-title__content"><h1 class="primary--text">끄적끄적 개발일지</h1></div><div class="v-app-bar-title__placeholder" style="visibility:visible;"><h1 class="primary--text">끄적끄적 개발일지</h1></div></div> <div role="list" class="v-list pa-0 v-sheet theme--light v-list--flat transparent"><div role="listbox" class="v-item-group theme--light v-list-item-group indigo--text"><div class="row mb-0 text-center no-gutters justify-center"><div class="col-lg-2 col"><a href="/" tabindex="0" block="" text="" role="option" aria-selected="false" class="py-2  v-list-item v-list-item--link theme--light primary--text"><div class="v-list-item__title">Home</div></a></div> <div class="col-lg-2 col"><a href="/category" aria-current="page" tabindex="0" block="" text="" role="option" aria-selected="false" class="py-2 v-item--active v-list-item--active v-list-item v-list-item--link theme--light primary--text"><div class="v-list-item__title">Category</div></a></div> <div class="col-lg-2 col"><a href="/profiles" tabindex="0" block="" text="" role="option" aria-selected="false" class="py-2 v-list-item v-list-item--link theme--light primary--text"><div class="v-list-item__title">Profiles</div></a></div></div></div></div> <hr role="separator" aria-orientation="horizontal" class="mb-3 v-divider theme--light"> <div><div data-v-52bca676><div class="px-0 col col-12" data-v-52bca676 data-v-52bca676><div class="pa-5 px-md-7 v-card v-sheet theme--light elevation-1" data-v-52bca676><div data-v-52bca676><a href="/category/redis/redis-event-notifications.html" aria-current="page" class="text-h4 font-weight-bold router-link-exact-active router-link-active" data-v-52bca676><div data-v-52bca676><!----></div>
          Redis Keyspace Notifications에 대해 알아보자
        </a> <br data-v-52bca676> <span class="text-caption grey--text text--darken-1 " data-v-52bca676>2023-07-19 &gt; 레디스
        </span></div> <hr role="separator" aria-orientation="horizontal" class="mt-4 mb-4 v-divider theme--light" data-v-52bca676> <div class="theme-container" data-v-52bca676><div class="toc" data-v-52bca676><ul><li><a href="/category/redis/redis-event-notifications.html#redis-keyspace-notifications">Redis Keyspace Notifications</a></li><li><a href="/category/redis/redis-event-notifications.html#notifications-유형">Notifications 유형</a></li><li><a href="/category/redis/redis-event-notifications.html#redis-keyspace-notifications-설정">Redis Keyspace Notifications 설정</a></li><li><a href="/category/redis/redis-event-notifications.html#성능-측정">성능 측정</a><ul><li><a href="/category/redis/redis-event-notifications.html#notify-keyspace-events-모든-이벤트-비활성화">notify-keyspace-events &quot;&quot; 모든 이벤트 비활성화</a></li><li><a href="/category/redis/redis-event-notifications.html#notify-keyspace-events-ake-모든-이벤트-활성화">notify-keyspace-events AKE 모든 이벤트 활성화</a></li></ul></li><li><a href="/category/redis/redis-event-notifications.html#스프링-부트-설정">스프링 부트 설정</a></li></ul></div> <div class="theme-default-content custom post markdown-body content__default" data-v-52bca676><h2 id="redis-keyspace-notifications"><a href="#redis-keyspace-notifications" class="header-anchor">#</a> Redis Keyspace Notifications</h2> <p>Redis에는 키 및 값의 변경 사항을 실시간으로 수신할 수 있는 Pub/Sub 기능을 제공한다.</p> <h2 id="notifications-유형"><a href="#notifications-유형" class="header-anchor">#</a> Notifications 유형</h2> <p>Redis 데이터 공간에 영향을 미치는 모든 작업에 대해 다음 두 가지 유형의 이벤트가 발생된다.
예를 들어 키를 삭제하는 명령인 <code>del myKey1</code> 이 실행되면 Redis는 다음 두 가지 명령이 트리거된다.</p> <div class="language-redis line-numbers-mode"><pre class="language-text"><code>PUBLISH __keyspace@0__:mykey1 del
PUBLISH __keyevent@0__:del mykey1
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>첫번째 PUBLISH 명령은 Key 중심 이벤트로, <code>del</code>이 이벤트의 메시지고
두번쨰 PUBLISH 명령은 명령 중심 이벤트로, <code>myKey1</code>이 이벤트의 메시지이다.
Sub 하는 쪽에서는 Subscribe 패턴 매칭을 통해서 두 가지 유형 중 관심있는 이벤트만 선택해서 알림을 받을 수 있다.</p> <h2 id="redis-keyspace-notifications-설정"><a href="#redis-keyspace-notifications-설정" class="header-anchor">#</a> Redis Keyspace Notifications 설정</h2> <p>기본적으로 Keyspace Notifications은 비활성화되어 있기 때문에, <code>redis.conf</code> 또는 <code>CONFIG SET</code> 명령어로 <code>notify-keyspace-events</code> 옵션을 활성화 할 수 있다.
옵션에는 다음 값들이 있다.
이벤트 종류</p> <ul><li>K   Keyspace events, publish prefix &quot;<strong>keyspace@<db></db></strong>:&quot;.</li> <li>E   Keyevent events, publish prefix &quot;<strong>keyevent@<db></db></strong>:&quot;.</li> <li>g   공통 명령: del, expire, rename, ...</li> <li>$   스트링(String) 명령</li> <li>l   리스트(List) 명령</li> <li>s   셋(Set) 명령</li> <li>h   해시(Hash) 명령</li> <li>z   소트 셋(Sorted set) 명령</li> <li>x   만료(Expired) 이벤트 (키가 만료될 때마다 생성되는 이벤트)</li> <li>e   퇴출(Evicted) 이벤트 (최대메모리 정책으로 키가 삭제될 때 생성되는 이벤트)</li> <li>A   모든 이벤트(g$lshzxe), &quot;AKE&quot;로 지정하면 모든 이벤트를 받는다.</li></ul> <p>여기서 K 또는 E는 필수적으로 있어야 하며, 나머지 값들은 선택적으로 설정할 수 있다.
예를 들어, 어떤 Key가 Expire되는지만 수신하고 싶다면 아래와 같이 설정하면 된다.</p> <div class="language- line-numbers-mode"><pre class="language-text"><code>notify-keyspace-events &quot;Kx&quot;: 키 이벤트 + 만료 이벤트 발생
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br></div></div><p>Redis 명령에 따른 이벤트 종류를 보고 싶다면 <a href="https://redis.io/docs/manual/keyspace-notifications/" target="_blank" rel="noopener noreferrer">공식문서<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>를 참조하자.</p> <h2 id="성능-측정"><a href="#성능-측정" class="header-anchor">#</a> 성능 측정</h2> <p>notify-keyspace-events 옵션을 모두 활성화 했을떄, 비활성화 했을 때 각가 redis-benchmark 를 통해 퍼모먼스를 테스트해보자.</p> <h3 id="notify-keyspace-events-모든-이벤트-비활성화"><a href="#notify-keyspace-events-모든-이벤트-비활성화" class="header-anchor">#</a> notify-keyspace-events &quot;&quot; 모든 이벤트 비활성화</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code># redis-cli config set notify-keyspace-events &quot;&quot;
# redis-benchmark -q 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>PING_INLINE: 3670.67 requests per second, p50=12.391 msec
PING_MBULK: 3668.78 requests per second, p50=12.551 msec
SET: 4601.72 requests per second, p50=9.087 msec
GET: 4604.90 requests per second, p50=8.999 msec
INCR: 4708.98 requests per second, p50=8.847 msec
LPUSH: 4750.14 requests per second, p50=8.847 msec
RPUSH: 4620.86 requests per second, p50=8.967 msec
LPOP: 3531.82 requests per second, p50=13.231 msec
RPOP: 3863.84 requests per second, p50=12.007 msec
SADD: 4677.05 requests per second, p50=8.775 msec
HSET: 4795.01 requests per second, p50=8.743 msec
SPOP: 3689.49 requests per second, p50=12.087 msec
ZADD: 3968.57 requests per second, p50=10.575 msec
ZPOPMIN: 3116.62 requests per second, p50=15.095 msec
LPUSH (needed to benchmark LRANGE): 3900.31 requests per second, p50=10.743 msec
LRANGE_100 (first 100 elements): 4876.86 requests per second, p50=8.343 msec
LRANGE_300 (first 300 elements): 3725.23 requests per second, p50=12.071 msec
LRANGE_500 (first 500 elements): 2396.59 requests per second, p50=20.159 msec
LRANGE_600 (first 600 elements): 2067.31 requests per second, p50=23.663 msec
MSET (10 keys): 4288.53 requests per second, p50=9.711 msec
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h3 id="notify-keyspace-events-ake-모든-이벤트-활성화"><a href="#notify-keyspace-events-ake-모든-이벤트-활성화" class="header-anchor">#</a> notify-keyspace-events AKE 모든 이벤트 활성화</h3> <div class="language- line-numbers-mode"><pre class="language-text"><code># redis-cli config set notify-keyspace-events AKE
# redis-benchmark -q 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><div class="language- line-numbers-mode"><pre class="language-text"><code>PING_INLINE: 3299.57 requests per second, p50=14.319 msec
PING_MBULK: 3115.85 requests per second, p50=15.039 msec
SET: 3974.25 requests per second, p50=10.399 msec
GET: 3828.19 requests per second, p50=10.959 msec
INCR: 3869.07 requests per second, p50=10.791 msec
LPUSH: 3835.24 requests per second, p50=11.095 msec
RPUSH: 4118.96 requests per second, p50=10.247 msec
LPOP: 3102.89 requests per second, p50=14.991 msec
RPOP: 3178.03 requests per second, p50=14.895 msec
SADD: 3834.94 requests per second, p50=10.983 msec
HSET: 3825.41 requests per second, p50=11.111 msec
SPOP: 3389.03 requests per second, p50=13.735 msec
ZADD: 3750.94 requests per second, p50=11.207 msec
ZPOPMIN: 3117.69 requests per second, p50=14.855 msec
LPUSH (needed to benchmark LRANGE): 3835.68 requests per second, p50=11.103 msec
LRANGE_100 (first 100 elements): 4953.68 requests per second, p50=8.247 msec
LRANGE_300 (first 300 elements): 3687.04 requests per second, p50=12.079 msec
LRANGE_500 (first 500 elements): 2410.28 requests per second, p50=20.191 msec
LRANGE_600 (first 600 elements): 2059.44 requests per second, p50=23.647 msec
MSET (10 keys): 4043.02 requests per second, p50=10.143 msec
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><p>p50 응답시간은 큰 차이가 없지만 초당 request 처리가 100~500 정도 줄어든 것을 볼 수 있다.<br>
따라서, 이벤트 수신이 필요없다면 redis의 해당 설정은 비활성화하는 것이 리소스를 효율적으로 쓰는데 도움이 될 것 이다.
옵션을 활성화하더라도 꼭 필요한 이벤트 유형 옵션만 설정하는 것이 좋다.</p> <h2 id="스프링-부트-설정"><a href="#스프링-부트-설정" class="header-anchor">#</a> 스프링 부트 설정</h2> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Configuration</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisConfig</span> <span class="token punctuation">{</span>


	<span class="token annotation punctuation">@Bean</span><span class="token punctuation">(</span>name <span class="token operator">=</span> <span class="token string">&quot;redisMessageTaskExecutor&quot;</span><span class="token punctuation">)</span>
	<span class="token keyword">public</span> <span class="token class-name">Executor</span> <span class="token function">redisMessageTaskExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">ThreadPoolTaskExecutor</span> threadPoolTaskExecutor <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ThreadPoolTaskExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		threadPoolTaskExecutor<span class="token punctuation">.</span><span class="token function">setCorePoolSize</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
		threadPoolTaskExecutor<span class="token punctuation">.</span><span class="token function">setMaxPoolSize</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> threadPoolTaskExecutor<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Bean</span>
	<span class="token keyword">public</span> <span class="token class-name">RedisMessageListenerContainer</span> <span class="token class-name">RedisMessageListener</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> connectionFactory<span class="token punctuation">,</span> <span class="token class-name">RedisMessageListener</span> redisMessageListener<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">RedisMessageListenerContainer</span> container <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisMessageListenerContainer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		container<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>connectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
		container<span class="token punctuation">.</span><span class="token function">addMessageListener</span><span class="token punctuation">(</span>redisMessageListener<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">PatternTopic</span><span class="token punctuation">(</span><span class="token string">&quot;*&quot;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		container<span class="token punctuation">.</span><span class="token function">setTaskExecutor</span><span class="token punctuation">(</span><span class="token function">asyncThreadTaskExecutor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> container<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>

	<span class="token annotation punctuation">@Bean</span>
	<span class="token keyword">public</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> <span class="token function">redisTemplate</span><span class="token punctuation">(</span><span class="token class-name">RedisConnectionFactory</span> connectionFactory<span class="token punctuation">)</span> <span class="token punctuation">{</span>
		<span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">Object</span><span class="token punctuation">&gt;</span></span> redisTemplate <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RedisTemplate</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token punctuation">&gt;</span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		redisTemplate<span class="token punctuation">.</span><span class="token function">setConnectionFactory</span><span class="token punctuation">(</span>connectionFactory<span class="token punctuation">)</span><span class="token punctuation">;</span>
		redisTemplate<span class="token punctuation">.</span><span class="token function">setKeySerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		redisTemplate<span class="token punctuation">.</span><span class="token function">setValueSerializer</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">StringRedisSerializer</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
		<span class="token keyword">return</span> redisTemplate<span class="token punctuation">;</span>
	<span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token annotation punctuation">@Component</span>
<span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">RedisMessageListener</span> <span class="token keyword">implements</span> <span class="token class-name">MessageListener</span> <span class="token punctuation">{</span>

    <span class="token keyword">private</span> <span class="token keyword">final</span> <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">CacheManager</span><span class="token punctuation">&gt;</span></span> cacheManagerList<span class="token punctuation">;</span>

    <span class="token annotation punctuation">@Override</span>
    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">onMessage</span><span class="token punctuation">(</span><span class="token keyword">final</span> <span class="token class-name">Message</span> message<span class="token punctuation">,</span> <span class="token keyword">final</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> pattern<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        log<span class="token punctuation">.</span><span class="token function">info</span><span class="token punctuation">(</span><span class="token string">&quot;{}&quot;</span><span class="token punctuation">,</span> message<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>RedisMessageListenerContainer 빈 등록 시, 주의할 점은 setTaskExecutor() 로 스레드풀을 사용하는 Executor를 등록해야 한다.<br>
setTaskExecutor()로 Executor를 등록하지 않으면 RedisMessageListenerContainer는 기본값으로 SimpleAsyncTaskExecutor가 사용되는데,
SimpleAsyncTaskExecutor 는 사용될 때 마다, 새로운 스레드를 만들어서 run() 하기 때문에 Redis에서 이벤트가 수신될 때 마다 새로운 스레드가 만들어지므로 주의하자.</p></div></div></div></div> <div data-v-52bca676></div></div></div></div> <footer prime="" class="v-footer mt-2 v-sheet theme--light v-footer--padless" style="background:#F3F5F7;"><div class="col col-12"><div class="text-center v-card v-card--flat v-sheet theme--light rounded-0" style="background:#F3F5F7;"><div class="v-card__text"><p>Copyright © 2021 All Right <em>끄적끄적 개발일지</em></p> <p>
          px201226@gmail.com .
          <a href="https://github.com/px201226" target="_blank">GitHub</a>
          .
          <a href="http://px201226.github.io/blog" target="_blank">Blog</a>
          .
        </p></div></div></div></footer></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.70752fd1.js" defer></script><script src="/assets/js/17.4dcf5890.js" defer></script><script src="/assets/js/44.4fd9959c.js" defer></script>
  </body>
</html>
